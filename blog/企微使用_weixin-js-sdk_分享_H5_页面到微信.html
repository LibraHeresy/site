<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>企微使用 weixin-js-sdk 分享 H5 页面到微信 | 天秤的异端</title>
    <meta name="description" content="Blog">
    <meta name="generator" content="VitePress v1.0.0-rc.45">
    <link rel="preload stylesheet" href="/site/assets/style.CimXUdda.css" as="style">
    
    <script type="module" src="/site/assets/app.D6StZtOy.js"></script>
    <link rel="preload" href="/site/assets/inter-roman-latin.Bu8hRsVA.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/site/assets/chunks/framework.DVBdlveE.js">
    <link rel="modulepreload" href="/site/assets/chunks/theme.Cz3hwMYl.js">
    <link rel="modulepreload" href="/site/assets/blog_企微使用_weixin-js-sdk_分享_H5_页面到微信.md.MxzJePdm.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar has-sidebar" data-v-ae24b3ad data-v-19c990f1><div class="wrapper" data-v-19c990f1><div class="container" data-v-19c990f1><div class="title" data-v-19c990f1><div class="VPNavBarTitle has-sidebar" data-v-19c990f1 data-v-ab179fa1><a class="title" href="/site/" data-v-ab179fa1><!--[--><!--]--><!----><span data-v-ab179fa1>LibraHeresy</span><!--[--><!--]--></a></div></div><div class="content" data-v-19c990f1><div class="content-body" data-v-19c990f1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-19c990f1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-19c990f1 data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/site/" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>首页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/site/blog/%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA_VitePress" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>博客</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/site/essay/%E5%A6%82%E4%BD%95%E5%BF%AB%E9%80%9F%E5%AE%8C%E6%88%90_Microsoft_Rewards_%E7%A7%AF%E5%88%86%E4%BB%BB%E5%8A%A1" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>短文</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/site/chat/%E4%B9%A6%E6%9E%B6" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>闲谈</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/site/note/%E9%BB%91%E6%9D%BF" tabindex="0" data-v-7f418b0f data-v-42ef59de><!--[--><span data-v-42ef59de>笔记</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><!----><span data-v-b6c34ac9>链接</span><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.google.com/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->谷歌<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link vp-external-link-icon" href="https://www.bilibili.com/" target="_blank" rel="noreferrer" data-v-43f1e123><!--[-->B站<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-19c990f1 data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-e6aabb21 data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-19c990f1 data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LibraHeresy" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><a class="VPSocialLink no-icon" href="https://juejin.cn/user/1881996885504375" aria-label="掘金" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><svg xmlns="http://www.w3.org/2000/svg" width="36" height="28" viewBox="0 0 36 28" fill="none">
            <title>掘金</title>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M17.5875 6.77268L21.8232 3.40505L17.5875 0.00748237L17.5837 0L13.3555 3.39757L17.5837 6.76894L17.5875 6.77268ZM17.5863 17.3955H17.59L28.5161 8.77432L25.5526 6.39453L17.59 12.6808H17.5863L17.5825 12.6845L9.61993 6.40201L6.66016 8.78181L17.5825 17.3992L17.5863 17.3955ZM17.5828 23.2891L17.5865 23.2854L32.2133 11.7456L35.1768 14.1254L28.5238 19.3752L17.5865 28L0.284376 14.3574L0 14.1291L2.95977 11.7531L17.5828 23.2891Z" fill="#1E80FF"/>
          </svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-19c990f1 data-v-d0bd9dde data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b6c34ac9><span class="vpi-more-horizontal icon" data-v-b6c34ac9></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-d0bd9dde><div class="item appearance" data-v-d0bd9dde><p class="label" data-v-d0bd9dde>Appearance</p><div class="appearance-action" data-v-d0bd9dde><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d0bd9dde data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d0bd9dde><div class="item social-links" data-v-d0bd9dde><div class="VPSocialLinks social-links-list" data-v-d0bd9dde data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/LibraHeresy" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><a class="VPSocialLink no-icon" href="https://juejin.cn/user/1881996885504375" aria-label="掘金" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><svg xmlns="http://www.w3.org/2000/svg" width="36" height="28" viewBox="0 0 36 28" fill="none">
            <title>掘金</title>
            <path fill-rule="evenodd" clip-rule="evenodd" d="M17.5875 6.77268L21.8232 3.40505L17.5875 0.00748237L17.5837 0L13.3555 3.39757L17.5837 6.76894L17.5875 6.77268ZM17.5863 17.3955H17.59L28.5161 8.77432L25.5526 6.39453L17.59 12.6808H17.5863L17.5825 12.6845L9.61993 6.40201L6.66016 8.78181L17.5825 17.3992L17.5863 17.3955ZM17.5828 23.2891L17.5865 23.2854L32.2133 11.7456L35.1768 14.1254L28.5238 19.3752L17.5865 28L0.284376 14.3574L0 14.1291L2.95977 11.7531L17.5828 23.2891Z" fill="#1E80FF"/>
          </svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-19c990f1 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-19c990f1><div class="divider-line" data-v-19c990f1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-d2ecc192><button data-v-d2ecc192>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-5d98c3a5 data-v-575e6a36><div class="curtain" data-v-575e6a36></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-575e6a36><span class="visually-hidden" id="sidebar-aria-label" data-v-575e6a36> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible" data-v-575e6a36 data-v-93e7e794><div class="item" role="button" tabindex="0" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><h2 class="text" data-v-93e7e794>VitePress</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-93e7e794><span class="vpi-chevron-right caret-icon" data-v-93e7e794></span></div></div><div class="items" data-v-93e7e794><!--[--><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA_VitePress" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>如何搭建 VitePress</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/%E4%BD%BF%E7%94%A8_GithubPages_%E9%83%A8%E7%BD%B2_VitePress" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>使用 Github Pages 部署 VitePress</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/VitePress_%E4%BD%BF%E7%94%A8_Gitalk_%E6%B7%BB%E5%8A%A0%E8%AF%84%E8%AE%BA%E5%8A%9F%E8%83%BD" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>VitePress 使用 Gitalk 添加评论功能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/Gitalk_%E8%87%AA%E5%8A%A8%E5%88%9D%E5%A7%8B%E5%8C%96%E8%AF%84%E8%AE%BA" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>Gitalk 自动初始化评论</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/VitePress_%E9%A2%84%E8%A7%88%E7%BB%84%E4%BB%B6" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>VitePress 预览组件</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible" data-v-575e6a36 data-v-93e7e794><div class="item" role="button" tabindex="0" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><h2 class="text" data-v-93e7e794>Electron</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-93e7e794><span class="vpi-chevron-right caret-icon" data-v-93e7e794></span></div></div><div class="items" data-v-93e7e794><!--[--><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/%E5%A6%82%E4%BD%95%E6%90%AD%E5%BB%BA_Electron_%E9%A1%B9%E7%9B%AE" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>如何搭建 Electron 项目</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible" data-v-575e6a36 data-v-93e7e794><div class="item" role="button" tabindex="0" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><h2 class="text" data-v-93e7e794>小程序</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-93e7e794><span class="vpi-chevron-right caret-icon" data-v-93e7e794></span></div></div><div class="items" data-v-93e7e794><!--[--><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/Taro_CI_%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E6%A1%86%E6%9E%B6%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%8E%E4%BD%BF%E7%94%A8" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>Taro CI 持续集成框架的配置与使用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/Taro_%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%95%E5%85%A5_Painter_%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E5%9B%BE%E7%89%87" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>Taro 小程序引入 Painter 实现动态生成图片</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-575e6a36><section class="VPSidebarItem level-0 collapsible has-active" data-v-575e6a36 data-v-93e7e794><div class="item" role="button" tabindex="0" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><h2 class="text" data-v-93e7e794>其他</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-93e7e794><span class="vpi-chevron-right caret-icon" data-v-93e7e794></span></div></div><div class="items" data-v-93e7e794><!--[--><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/%E4%BC%81%E5%BE%AE%E4%BD%BF%E7%94%A8_weixin-js-sdk_%E5%88%86%E4%BA%AB_H5_%E9%A1%B5%E9%9D%A2%E5%88%B0%E5%BE%AE%E4%BF%A1" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>企微使用 weixin-js-sdk 分享 H5 页面到微信</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/%E4%BC%81%E5%BE%AE%E4%BD%BF%E7%94%A8_wecom_jssdk_%E5%88%86%E4%BA%AB%E6%B6%88%E6%81%AF%E5%8D%A1%E7%89%87%E5%88%B0%E4%BC%9A%E8%AF%9D" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>企微使用 @wecom/jssdk 分享消息卡片到会话</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/%E5%B0%9D%E8%AF%95%E7%94%A8_Vue_%E5%86%99%E4%B8%80%E4%B8%AA%E8%A1%A8%E6%A0%BC%E7%BB%84%E4%BB%B6" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>尝试用 Vue 写一个表格组件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/Vue_%E4%BD%BF%E7%94%A8_TinyMCE_%E5%AF%8C%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>Vue 使用 TinyMCE 富文本编辑器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/Vue_%E5%BC%95%E5%85%A5_WPS_JS_SDK" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>Vue 引入 WPS JS-SDK</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-93e7e794 data-v-93e7e794><div class="item" data-v-93e7e794><div class="indicator" data-v-93e7e794></div><a class="VPLink link link" href="/site/blog/Node_%E7%8E%AF%E5%A2%83%E4%BD%BF%E7%94%A8_Puppeteer_%E5%AE%9E%E7%8E%B0%E8%B0%83%E7%94%A8WPS_JS_SDK" data-v-93e7e794><!--[--><p class="text" data-v-93e7e794>Node 环境使用 Puppeteer 实现调用 WPS JS-SDK</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-sidebar has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-935f8a84><div class="content" data-v-935f8a84><div class="outline-marker" data-v-935f8a84></div><div class="outline-title" role="heading" aria-level="2" data-v-935f8a84>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-935f8a84><span class="visually-hidden" id="doc-outline-aria-label" data-v-935f8a84> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-935f8a84 data-v-b933a997><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _site_blog_%E4%BC%81%E5%BE%AE%E4%BD%BF%E7%94%A8_weixin-js-sdk_%E5%88%86%E4%BA%AB_H5_%E9%A1%B5%E9%9D%A2%E5%88%B0%E5%BE%AE%E4%BF%A1" data-v-39a288b8><div><h1 id="企微使用-weixin-js-sdk-分享-h5-页面到微信" tabindex="-1">企微使用 weixin-js-sdk 分享 H5 页面到微信 <a class="header-anchor" href="#企微使用-weixin-js-sdk-分享-h5-页面到微信" aria-label="Permalink to &quot;企微使用 weixin-js-sdk 分享 H5 页面到微信&quot;">​</a></h1><h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>接到一个需求，实现企业微信环境转发 <code>H5</code> 页面到微信好友和朋友圈，并保留卡片形式。</p><p>一上手就发现问题了，企微的 <code>JS-SDK</code> 它不更新了。兜兜转转发现，发现好像企微和微信的 <code>JS-SDK</code> 统一用 <code>@wecom/jssdk</code>。</p><p>而我在发现这个状况之前已经用了第三方封装的包，<code>weixin-js-sdk</code>。幸好问题不大，因为这个包只是将官方 <code>weixin-js-sdkweixin-js-sdkJS-SDK</code> 转为了 <code>CommonJS</code> 格式。</p><p>但我的建议是使用 <code>@wecom/jssdk</code> ，因为我已经发现有些方法 <code>weixin-js-sdk</code> 并不支持，比如 <code>updateAppMessageShareData</code> 和 <code>updateTimelineShareData</code> ，这两个新的分享方法。</p><h2 id="环境" tabindex="-1">环境 <a class="header-anchor" href="#环境" aria-label="Permalink to &quot;环境&quot;">​</a></h2><blockquote><p>企业微信 v4.1.3(21966)</p><p>weixin-js-sdk v1.6.0</p></blockquote><h2 id="实现" tabindex="-1">实现 <a class="header-anchor" href="#实现" aria-label="Permalink to &quot;实现&quot;">​</a></h2><h3 id="引入微信-js-sdk" tabindex="-1">引入微信 JS-SDK <a class="header-anchor" href="#引入微信-js-sdk" aria-label="Permalink to &quot;引入微信 JS-SDK&quot;">​</a></h3><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// terminal</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">npm install weixin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">js</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sdk</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// updateShare.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> wx </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;weixin-js-sdk&#39;</span></span></code></pre></div><h3 id="注册企微接口权限" tabindex="-1">注册企微接口权限 <a class="header-anchor" href="#注册企微接口权限" aria-label="Permalink to &quot;注册企微接口权限&quot;">​</a></h3><p>这一步其实挺简单的，调用 <code>wx.config</code> 接口就行，重点是参数的获取，还有就是注册以后的 <code>url</code> 不会变动了，如果切换页面你就要重新注册一次。</p><p><a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/JS-SDK.html#0" target="_blank" rel="noreferrer">JS-SDK 说明文档</a></p><p><a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/JS-SDK.html#62" target="_blank" rel="noreferrer">附录 1-JS-SDK 使用权限签名算法</a></p><p><a href="https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/JS-SDK.html#63" target="_blank" rel="noreferrer">附录 2-所有 JS 接口列表</a></p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 注册接口权限</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> jsapiTicket</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 我是后端返回的，前端也可以自己获取，具体的看附录1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> timestamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Date.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">substring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 获取时间戳</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nonceStr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getuuid</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 获取uuid</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> url</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 注册url，需要与当前页面一致</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> signature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> CryptoJS.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">SHA1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  `jsapi_ticket=${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">jsapiTicket</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&amp;noncestr=${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">nonceStr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&amp;timestamp=${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">timestamp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}&amp;url=${</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">url</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">}`</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 生成签名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  debug: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 是否开启调试模式，开启的话，每调用一次api就会回调弹出结果弹窗。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  appId: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 填写企业号corpid，但是要注意的是，如果该网页被分享到微信，那你就要用微信公众号的appid才能获取到接口权限</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  timestamp: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 必填，生成签名的时间戳。注意！微信要的时间戳精度是到秒</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  nonceStr: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 必填，生成签名的随机串。随便一个uuid就行，只要是不重复的随机串都可以。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  signature: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 必填，签名，见附录1。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  jsApiList: [], </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 必填，需要使用的JS接口列表，所有JS接口列表见附录2。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 成功回调</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ready</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // config信息验证成功会执行ready函数</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 检查环境是否支持指定JS接口</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">checkJsApi</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    jsApiList: [],</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">res</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 失败回调</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // config信息验证失败会执行error函数，如签名过期导致验证失败</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 具体错误信息可以打开config的debug模式查看，也可以在返回的err参数中查看，对于SPA可以在这里更新签名。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><h3 id="调用分享接口" tabindex="-1">调用分享接口 <a class="header-anchor" href="#调用分享接口" aria-label="Permalink to &quot;调用分享接口&quot;">​</a></h3><p>最难的就是注册接口权限了，如果你成功了，那接下来就是一片坦途。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  title: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分享卡片标题</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  desc: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分享卡片描述</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  imgUrl: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分享卡片头像</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  link: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分享卡片点击打开的网址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  success</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 用户确认分享后执行的回调函数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  cancel</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 用户取消分享后执行的回调函数</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分享接口的入参都差不多</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分享到微信，即将废弃</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onMenuShareAppMessage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 分享到朋友圈，即将废弃</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">wx.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">onMenuShareTimeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config)</span></span></code></pre></div><h2 id="问题" tabindex="-1">问题 <a class="header-anchor" href="#问题" aria-label="Permalink to &quot;问题&quot;">​</a></h2><h3 id="再次分享卡片头像图不加载" tabindex="-1">再次分享卡片头像图不加载 <a class="header-anchor" href="#再次分享卡片头像图不加载" aria-label="Permalink to &quot;再次分享卡片头像图不加载&quot;">​</a></h3><p>常见原因就是你的头像图太大，导致加载失败，最好控制在 <code>200k</code> 以内，还有就是可能你的头像图链接挂了。</p><h3 id="错误码-63002-invalid-signature" tabindex="-1">错误码:63002, invalid signature <a class="header-anchor" href="#错误码-63002-invalid-signature" aria-label="Permalink to &quot;错误码:63002, invalid signature&quot;">​</a></h3><p>如果你确定你的 <code>noncestr</code> 和 <code>jsapi_ticket</code> 没有问题，但就是提示非法签名，那可能是因为你的 <code>timestamp</code>。</p><p>因为微信的 <code>timestamp</code> 精度是到秒，而 <code>JS</code> 的 <code>Date.now()</code> 方法精度是到毫秒。</p><p>真不愧是你啊，微信。</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> js_timestamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Date.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> wx_timestamp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Date.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">substring</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 需要这样处理</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-09de1c0f><!--[--><!--[--><!--[--><!--[--><div class="share-to-app" data-v-3b71b4b3><div class="share-wrap" data-v-3b71b4b3><div class="share-btn" data-v-3b71b4b3><svg width="35" height="35" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="share-btn-icon" data-v-3b71b4b3><circle cx="20" cy="20" r="20" fill="#57BB40" data-v-3b71b4b3></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M19.7168 13.7118C19.0097 13.7118 18.4441 14.2616 18.4441 14.9491C18.4441 15.6366 19.0097 16.1864 19.7168 16.1864C20.424 16.1864 20.9896 15.6366 20.9896 14.9491C20.9896 14.2616 20.424 13.7118 19.7168 13.7118ZM13.6355 13.7118C12.9292 13.7118 12.3628 14.2616 12.3628 14.9491C12.3628 15.6366 12.9292 16.1864 13.6355 16.1864C14.3427 16.1864 14.909 15.6366 14.909 14.9491C14.909 14.2616 14.3427 13.7118 13.6355 13.7118ZM17.1724 22.9225C17.1724 23.61 17.314 24.2974 17.5964 24.8472H16.7484C15.7581 24.8472 14.6269 24.7104 13.6366 24.4351L10.1016 26.0845L10.9503 23.3347C8.68727 21.9605 7.27295 19.8982 7.27295 17.4236C7.27295 13.2996 11.5159 10 16.6068 10C21.273 10 25.0919 12.7498 25.7991 16.1863H25.0919C20.7074 16.1863 17.1724 19.2107 17.1724 22.9225ZM27.9199 19.8983C27.3543 19.8983 26.9296 20.3105 26.9296 20.8603C26.9296 21.4109 27.3543 21.8231 27.9199 21.8231C28.4855 21.8231 28.9102 21.4109 28.9102 20.8603C28.9102 20.3105 28.4855 19.8983 27.9199 19.8983ZM22.8285 19.8983C22.263 19.8983 21.839 20.3105 21.839 20.8603C21.839 21.4109 22.263 21.8231 22.8285 21.8231C23.3941 21.8231 23.8181 21.4109 23.8181 20.8603C23.8181 20.3105 23.3941 19.8983 22.8285 19.8983ZM29.7576 28.0091L30.4647 30.2083L27.9193 28.8342C27.0705 29.1087 26.2226 29.2464 25.233 29.2464C21.1308 29.2464 17.7374 26.4965 17.7374 23.06C17.7374 19.6235 21.1308 16.8737 25.233 16.8737C29.3336 16.8737 32.727 19.6235 32.727 23.06C32.727 24.9847 31.5966 26.7718 29.7576 28.0091Z" fill="white" data-v-3b71b4b3></path></svg><span data-v-3b71b4b3>微信</span></div><div class="share-btn" data-v-3b71b4b3><svg data-v-75612277="" width="35" height="35" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="share-btn-icon" data-v-3b71b4b3><circle cx="20" cy="20" r="20" fill="#4CA2E5" data-v-3b71b4b3></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M29.0365 24.2657C28.9059 22.7032 28.0439 20.9636 27.6915 20.0894L26.7801 17.8395C26.7515 16.9025 27.0413 14.7516 25.5216 12.0594C23.9972 9.36651 20.9438 9.12432 20.3787 9.09627C19.8136 9.06821 16.2817 9.04089 14.5447 11.9715C12.8077 14.9015 13.277 17.8395 13.277 17.8395L12.3053 20.1049C12.3053 20.1049 11.8538 21.1393 11.4627 22.3968C11.0715 23.6543 10.6796 25.6317 11.0715 26.0334C11.4627 26.435 12.8804 24.194 13.011 23.9866C13.011 23.9866 13.1123 25.0565 13.3805 25.6177C13.5954 26.0659 14.1103 27.1845 15.1515 28.0617C14.6514 28.216 13.4509 28.6288 13.2739 29.0578C13.052 29.6027 13.4478 29.667 14.1242 29.7039C14.8006 29.7408 18.0426 29.8242 19.5964 29.6168C19.6134 29.6138 19.6273 29.6116 19.6443 29.6094C19.7966 29.6138 19.9388 29.6168 20.0764 29.6168C20.1638 29.6168 20.2651 29.6138 20.374 29.6116C20.3841 29.6138 20.3957 29.6138 20.4057 29.6168C21.9587 29.8242 25.2031 29.7408 25.8772 29.7039C26.5536 29.667 26.947 29.6027 26.7275 29.0578C26.5482 28.6214 25.3144 28.2042 24.829 28.0565C24.9805 27.9273 25.1281 27.7885 25.2734 27.6386C27.0243 25.8 26.8798 24.6393 26.9524 23.9747C26.9524 23.9747 28.4281 26.0075 28.7466 26.0769C29.0659 26.1463 29.1648 25.8274 29.0365 24.2657Z" fill="white" data-v-3b71b4b3></path></svg><span data-v-3b71b4b3>QQ</span></div><div class="share-btn" data-v-3b71b4b3><svg data-v-75612277="" width="35" height="35" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" class="share-btn-icon" data-v-3b71b4b3><circle cx="20" cy="20" r="20" fill="#F4BF41" data-v-3b71b4b3></circle><path fill-rule="evenodd" clip-rule="evenodd" d="M25.7608 17.8223L18.7132 22.8777C18.7132 22.8777 21.5417 23.2974 25.8074 23.2492L25.6134 22.4129L31.6916 17.147C31.8029 17.05 31.8457 16.8958 31.7999 16.7552C31.7547 16.6145 31.6291 16.5145 31.481 16.5025L23.4685 15.8143L20.3384 8.40576C20.2812 8.27038 20.1474 8.18164 20 8.18164C19.8526 8.18164 19.7187 8.27038 19.6615 8.40576L16.5307 15.8143L8.51822 16.5025C8.37081 16.5145 8.24522 16.6145 8.19934 16.7552C8.15422 16.8958 8.19708 17.05 8.30839 17.147L14.3866 22.4129L12.5651 30.2472C12.5312 30.3901 12.5869 30.5405 12.7065 30.6277C12.8268 30.7135 12.9862 30.7195 13.1133 30.6443L20 26.4906L26.8866 30.6443C26.9453 30.6811 27.0107 30.6969 27.0769 30.6969C27.1536 30.6969 27.2288 30.6744 27.2927 30.6277C27.4123 30.5405 27.4687 30.3901 27.4349 30.2472L25.9947 24.0517C26.6121 23.7411 27.2927 23.2154 27.2927 23.2154C27.2927 23.2154 24.5958 24.5323 14.9138 23.8885L21.9305 18.803C21.9305 18.803 21.6545 18.3736 12.8606 18.0675C12.2718 18.0472 20.0301 16.5965 25.7608 17.8223Z" fill="white" data-v-3b71b4b3></path></svg><span data-v-3b71b4b3>QQ空间</span></div></div></div><!--]--><!--]--><!--]--><!--]--><div class="edit-info" data-v-09de1c0f><!----><div class="last-updated" data-v-09de1c0f><p class="VPLastUpdated" data-v-09de1c0f data-v-7e05ebdb>更新于: <time datetime="2024-03-19T14:45:04.000Z" data-v-7e05ebdb></time></p></div></div><nav class="prev-next" data-v-09de1c0f><div class="pager" data-v-09de1c0f><a class="VPLink link pager-link prev" href="/site/blog/Taro_%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%BC%95%E5%85%A5_Painter_%E5%AE%9E%E7%8E%B0%E5%8A%A8%E6%80%81%E7%94%9F%E6%88%90%E5%9B%BE%E7%89%87" data-v-09de1c0f><!--[--><span class="desc" data-v-09de1c0f>上一篇</span><span class="title" data-v-09de1c0f>Taro 小程序引入 Painter 实现动态生成图片</span><!--]--></a></div><div class="pager" data-v-09de1c0f><a class="VPLink link pager-link next" href="/site/blog/%E4%BC%81%E5%BE%AE%E4%BD%BF%E7%94%A8_wecom_jssdk_%E5%88%86%E4%BA%AB%E6%B6%88%E6%81%AF%E5%8D%A1%E7%89%87%E5%88%B0%E4%BC%9A%E8%AF%9D" data-v-09de1c0f><!--[--><span class="desc" data-v-09de1c0f>下一篇</span><span class="title" data-v-09de1c0f>企微使用 @wecom/jssdk 分享消息卡片到会话</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>Released under the MIT License.</p><p class="copyright" data-v-e315a0ad>Copyright © 2023-present LibraHeresy</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"blog_vue_使用_tinymce_富文本编辑器.md\":\"e2ckrSbz\",\"blog_gitalk_自动初始化评论.md\":\"D3OsbNt2\",\"blog_taro_小程序引入_painter_实现动态生成图片.md\":\"D3qiVYl2\",\"blog_vitepress_使用_gitalk_添加评论功能.md\":\"ByacCJpP\",\"blog_vue_引入_wps_js_sdk.md\":\"0Ej7F-Hd\",\"blog_如何搭建_electron_项目.md\":\"n8zFcJ8h\",\"blog_如何搭建_vitepress.md\":\"DBHDwCDB\",\"blog_尝试用_vue_写一个表格组件.md\":\"B0fzzLG_\",\"chat_书架.md\":\"DsvT1_h5\",\"essay_关于_gitee_的仓库镜像管理功能.md\":\"C55ebgm_\",\"essay_如何快速完成_microsoft_rewards_积分任务.md\":\"Do2inXKb\",\"index.md\":\"DOo7J4s6\",\"blog_node_环境使用_puppeteer_实现调用wps_js_sdk.md\":\"BwPcgVkw\",\"blog_企微使用_wecom_jssdk_分享消息卡片到会话.md\":\"pz8T9cUf\",\"blog_vitepress_预览组件.md\":\"Bnoz5shZ\",\"blog_企微使用_weixin-js-sdk_分享_h5_页面到微信.md\":\"MxzJePdm\",\"blog_使用_githubpages_部署_vitepress.md\":\"CR_rqjkD\",\"blog_taro_ci_持续集成框架的配置与使用.md\":\"9mGDyov9\",\"note_handbook_git.md\":\"DXxw0xTF\",\"note_handbook_lodash.md\":\"-ZVDguPu\",\"note_handbook_nvm.md\":\"Bc8dTrcP\",\"note_handbook_pm2.md\":\"BC0LhM5r\",\"note_handbook_site.md\":\"iMaiQef2\",\"note_黑板.md\":\"hUVHUyuH\",\"template.md\":\"BKHC5zN5\",\"note_handbook_vs_code.md\":\"0VTReyy-\"}");function deserializeFunctions(r){return Array.isArray(r)?r.map(deserializeFunctions):typeof r=="object"&&r!==null?Object.keys(r).reduce((t,n)=>(t[n]=deserializeFunctions(r[n]),t),{}):typeof r=="string"&&r.startsWith("_vp-fn_")?new Function(`return ${r.slice(7)}`)():r};window.__VP_SITE_DATA__=deserializeFunctions(JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"LibraHeresy\",\"titleTemplate\":\"天秤的异端\",\"description\":\"Blog\",\"base\":\"/site/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"首页\",\"link\":\"/\"},{\"text\":\"博客\",\"link\":\"/blog/如何搭建_VitePress\",\"activeMatch\":\"/blog/\"},{\"text\":\"短文\",\"link\":\"/essay/如何快速完成_Microsoft_Rewards_积分任务\",\"activeMatch\":\"/essay/\"},{\"text\":\"闲谈\",\"link\":\"/chat/书架\",\"activeMatch\":\"/chat/\"},{\"text\":\"笔记\",\"link\":\"/note/黑板\",\"activeMatch\":\"/home/\"},{\"text\":\"链接\",\"items\":[{\"text\":\"谷歌\",\"link\":\"https://www.google.com/\"},{\"text\":\"B站\",\"link\":\"https://www.bilibili.com/\"}]}],\"sidebar\":{\"/blog/\":{\"base\":\"/blog/\",\"items\":[{\"text\":\"VitePress\",\"collapsed\":false,\"items\":[{\"text\":\"如何搭建 VitePress\",\"link\":\"如何搭建_VitePress\"},{\"text\":\"使用 Github Pages 部署 VitePress\",\"link\":\"使用_GithubPages_部署_VitePress\"},{\"text\":\"VitePress 使用 Gitalk 添加评论功能\",\"link\":\"VitePress_使用_Gitalk_添加评论功能\"},{\"text\":\"Gitalk 自动初始化评论\",\"link\":\"Gitalk_自动初始化评论\"},{\"text\":\"VitePress 预览组件\",\"link\":\"VitePress_预览组件\"}]},{\"text\":\"Electron\",\"collapsed\":false,\"items\":[{\"text\":\"如何搭建 Electron 项目\",\"link\":\"如何搭建_Electron_项目\"}]},{\"text\":\"小程序\",\"collapsed\":false,\"items\":[{\"text\":\"Taro CI 持续集成框架的配置与使用\",\"link\":\"Taro_CI_持续集成框架的配置与使用\"},{\"text\":\"Taro 小程序引入 Painter 实现动态生成图片\",\"link\":\"Taro_小程序引入_Painter_实现动态生成图片\"}]},{\"text\":\"其他\",\"collapsed\":true,\"items\":[{\"text\":\"企微使用 weixin-js-sdk 分享 H5 页面到微信\",\"link\":\"企微使用_weixin-js-sdk_分享_H5_页面到微信\"},{\"text\":\"企微使用 @wecom/jssdk 分享消息卡片到会话\",\"link\":\"企微使用_wecom_jssdk_分享消息卡片到会话\"},{\"text\":\"尝试用 Vue 写一个表格组件\",\"link\":\"尝试用_Vue_写一个表格组件\"},{\"text\":\"Vue 使用 TinyMCE 富文本编辑器\",\"link\":\"Vue_使用_TinyMCE_富文本编辑器\"},{\"text\":\"Vue 引入 WPS JS-SDK\",\"link\":\"Vue_引入_WPS_JS_SDK\"},{\"text\":\"Node 环境使用 Puppeteer 实现调用 WPS JS-SDK\",\"link\":\"Node_环境使用_Puppeteer_实现调用WPS_JS_SDK\"}]}]},\"/essay/\":{\"base\":\"/essay/\",\"items\":[{\"text\":\"如何快速完成 Microsoft Rewards 积分任务\",\"link\":\"如何快速完成_Microsoft_Rewards_积分任务\"},{\"text\":\"关于 Gitee 的仓库镜像管理功能\",\"link\":\"关于_Gitee_的仓库镜像管理功能\"}]},\"/chat/\":{\"base\":\"/chat/\",\"items\":[{\"text\":\"书架\",\"link\":\"书架\"}]},\"/note/\":{\"base\":\"/note/\",\"items\":[{\"text\":\"黑板\",\"link\":\"黑板\"},{\"text\":\"手册\",\"items\":[{\"text\":\"Visual Studio Code\",\"link\":\"handbook_vs_code\"},{\"text\":\"Git\",\"link\":\"handbook_git\"},{\"text\":\"PM2\",\"link\":\"handbook_pm2\"},{\"text\":\"nvm\",\"link\":\"handbook_nvm\"},{\"text\":\"Lodash\",\"link\":\"handbook_lodash\"},{\"text\":\"网站\",\"link\":\"handbook_site\"}]}]}},\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright © 2023-present LibraHeresy\"},\"search\":{\"provider\":\"local\"},\"lastUpdated\":{\"text\":\"更新于\",\"formatOptions\":{\"dateStyle\":\"medium\",\"timeStyle\":\"short\"}},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/LibraHeresy\",\"ariaLabel\":\"github\"},{\"icon\":{\"svg\":\"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"36\\\" height=\\\"28\\\" viewBox=\\\"0 0 36 28\\\" fill=\\\"none\\\">\\n            <title>掘金</title>\\n            <path fill-rule=\\\"evenodd\\\" clip-rule=\\\"evenodd\\\" d=\\\"M17.5875 6.77268L21.8232 3.40505L17.5875 0.00748237L17.5837 0L13.3555 3.39757L17.5837 6.76894L17.5875 6.77268ZM17.5863 17.3955H17.59L28.5161 8.77432L25.5526 6.39453L17.59 12.6808H17.5863L17.5825 12.6845L9.61993 6.40201L6.66016 8.78181L17.5825 17.3992L17.5863 17.3955ZM17.5828 23.2891L17.5865 23.2854L32.2133 11.7456L35.1768 14.1254L28.5238 19.3752L17.5865 28L0.284376 14.3574L0 14.1291L2.95977 11.7531L17.5828 23.2891Z\\\" fill=\\\"#1E80FF\\\"/>\\n          </svg>\"},\"link\":\"https://juejin.cn/user/1881996885504375\",\"ariaLabel\":\"掘金\"}],\"docFooter\":{\"prev\":\"上一篇\",\"next\":\"下一篇\"},\"outline\":{\"level\":[2,3]},\"sitemap\":{\"hostname\":\"https://libraheresy.github.io/site\",\"transformItems\":\"_vp-fn_(items) => {\\n        items = items.filter((i) => !i.url.inludes(\\\"chat\\\"));\\n        return items;\\n      }\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}"));</script>
    
  </body>
</html>